<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Your Profile</title>
    <link rel="stylesheet" href="styles.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
</head>
<body>
    <header>
        <h1>ðŸŒ· Letâ€™s Get to Know Each Other ðŸŒ·</h1>
        <h3>I think you are an incredible and genuine person, and I'd love to learn more about you!</h3>
    </header>
    <div class="container">

        <!-- About Me Display Section -->

        <section id="AboutMe">
            <h2>About Me ðŸ’«</h2>
            <div class="about-me-card">
                <ul id="aboutMeText"></ul>
            </div>
        </section>  

        <section id="bondingQuestions">
            <h2>Tell me about yourself</h2>
    
            <script type="text/javascript"
                src="https://cdn.jsdelivr.net/npm/@emailjs/browser@4/dist/email.min.js">
            </script>
            <script>
                (function() {
                    emailjs.init("torhjkGsU4X3vG3Bn");
                })();
            
                // Check email count in local storage
                function checkEmailLimit() {
                    let emailCount = localStorage.getItem("emailCount");
                    if (!emailCount) {
                        localStorage.setItem("emailCount", 0);
                        emailCount = 0;
                    }
                    return parseInt(emailCount, 10);
                }
    
                function incrementEmailCount() {
                    let emailCount = checkEmailLimit();
                    emailCount += 1;
                    localStorage.setItem("emailCount", emailCount);
                }
    
                function sendEmail(event) {
                    event.preventDefault();
    
                    // Check if email limit is reached
                    if (checkEmailLimit() >= 3) {
                        document.getElementById("responseMessage").style.display = "block";
                        document.getElementById("responseMessage").innerHTML = "<h3>Youâ€™ve reached the maximum number of submissions allowed.</h3>";
                        return;
                    }
    
                    // Collecting data from the form
                    const unexpectedFact = document.querySelector('textarea[name="unexpectedFact"]').value;
                    const dreamDestination = document.querySelector('textarea[name="dreamDestination"]').value;
                    const biggestFear = document.querySelector('textarea[name="biggestFear"]').value;
    
                    emailjs.send("service_ce7g4hx","template_ug3oiii",{
                        from_name: dreamDestination,
                        to_name: unexpectedFact,
                        message: biggestFear,
                    })
                        .then(response => {
                            incrementEmailCount();  // Increment email count on success
                            document.getElementById("responseMessage").style.display = "block";
                            document.getElementById("responseMessage").innerHTML = "<h3>Thanks for sharing! Your response has been submitted successfully.</h3>";
                        })
                        .catch(error => {
                            document.getElementById("responseMessage").style.display = "block";
                            document.getElementById("responseMessage").innerHTML = "<h3>Oops! Something went wrong. Please try again later.</h3>";
                        });
                }
            </script>
    
            <form id="bondingForm" onsubmit="sendEmail(event)">
                <div class="bonding-question">
                    <h3>1. What's something unexpected about you that most people donâ€™t know?</h3>
                    <textarea name="unexpectedFact" rows="3" placeholder="Write your answer here..."></textarea>
                </div>
    
                <div class="bonding-question">
                    <h3>2. If you could travel anywhere in the world, where would you go, and why?</h3>
                    <textarea name="dreamDestination" rows="3" placeholder="Write your answer here..."></textarea>
                </div>
    
                <div class="bonding-question">
                    <h3>3. What's your biggest fear, and how do you usually deal with it?</h3>
                    <textarea name="biggestFear" rows="3" placeholder="Write your answer here..."></textarea>
                </div>
    
                <button type="submit">Submit Your Answers</button>
            </form>
    
            <div id="responseMessage" style="display:none;"></div>
        </section>

        <!-- Quiz Display Section -->
        <section id="quiz">
            <h2>Quiz About Me ðŸŒŸ</h2>
            <div class="quiz-wrapper"> <!-- Outer card wrapper for the quiz -->
                <form id="quizForm">
                    <div id="filled-quesions"></div>
                    <button type="button" class="quiz-button" onclick="checkAnswers()">Submit Answers ðŸŽ‰</button>
                </form>
                <div id="quizResults" class="quiz-results" style="display:none;"></div>
            </div>
        </section>
    </div>
    
    <footer>
        <p>Â© 2024 Sari</p>
    </footer>

    
    <!-- alert -->
    <div id="responseAlert" class="cute-modal" style="display: none;">
        <div class="cute-modal-content">
            <span class="close-btn" onclick="closeAlert()">&times;</span>
            <span class="icon">ðŸ’Œ</span>
            <div id="alert-title"></div>
            <div id="alert-msg"></div>
            <button id="shareButton" onclick="shareResults()">Share Results as PNG</button> <!-- New share button -->
        </div>
    </div>
    <!-- end of alert -->

    <script src="display.js"></script>
</body>
</html>
